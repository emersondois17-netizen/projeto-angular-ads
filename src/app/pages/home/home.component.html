<div class="pb-20 animate-in fade-in duration-500">
  
  @if (loading) {
     <div class="h-[80vh] flex items-center justify-center">
        <div class="flex flex-col items-center gap-4">
           <div class="w-12 h-12 border-4 border-purple-600 border-t-transparent rounded-full animate-spin"></div>
           <p class="text-gray-400 text-sm animate-pulse">Carregando animes...</p>
        </div>
     </div>
  } @else {
     
     @if (searchResults.length > 0) {
        <div class="max-w-7xl mx-auto px-6 pt-32">
           <div class="flex items-center gap-4 mb-8">
              <button (click)="clearSearch()" class="p-2 rounded-full bg-white/10 hover:bg-white/20 transition-colors">
                 <lucide-icon name="arrow-left" class="text-white w-5 h-5"></lucide-icon>
              </button>
              <h2 class="text-2xl font-bold text-white">
                 Resultados para <span class="text-purple-400">"{{ lastSearch }}"</span>
              </h2>
           </div>

           <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-6">
              @for (anime of searchResults; track anime.mal_id) {
                 <app-anime-card 
                    [anime]="anime" 
                    [isFav]="store.isFav(anime.mal_id)" 
                    [isWatch]="store.isWatch(anime.mal_id)" 
                    [isWatched]="store.isWatched(anime.mal_id)" 
                    (onClick)="openModal($event)">
                 </app-anime-card>
              }
           </div>
        </div>
     } 
     
     @else {
        
        @if (topAnimes.length > 0) {
           <app-hero-carousel 
              [animes]="topAnimes.slice(0, 5)" 
              (onDetails)="openModal($event)"
              (onWatch)="openModal($event)">
           </app-hero-carousel>
        }

        <div class="max-w-7xl mx-auto px-6 space-y-16 mt-12">
           
           <div>
              <div class="flex items-center justify-between mb-6">
                 <h2 class="text-2xl md:text-3xl font-bold text-white border-l-4 border-purple-500 pl-4">Tendências da Semana</h2>
              </div>
              <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-6">
                 @for (anime of topAnimes.slice(5); track anime.mal_id) {
                    <app-anime-card 
                       [anime]="anime" 
                       [isFav]="store.isFav(anime.mal_id)"
                       [isWatch]="store.isWatch(anime.mal_id)"
                       [isWatched]="store.isWatched(anime.mal_id)"
                       (onClick)="openModal($event)">
                    </app-anime-card>
                 }
              </div>
           </div>

           <div>
              <h2 class="text-2xl font-bold text-white border-l-4 border-blue-500 pl-4 mb-6">Clássicos & Populares</h2>
              <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-6">
                 @for (anime of popularAnimes; track anime.mal_id) {
                    <app-anime-card 
                       [anime]="anime" 
                       [isFav]="store.isFav(anime.mal_id)"
                       [isWatch]="store.isWatch(anime.mal_id)"
                       [isWatched]="store.isWatched(anime.mal_id)"
                       (onClick)="openModal($event)">
                    </app-anime-card>
                 }
              </div>
           </div>
        </div>
     }
  }
</div>